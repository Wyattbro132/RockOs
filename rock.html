<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rock OS</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --bg: #0f172a;
      --surface: #1e293b;
      --accent: #ea580c;
      --text: #f1f5f9;
      --text-dim: #94a3b8;
      --shadow: 0 10px 25px rgba(0,0,0,0.5);
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      height: 100vh;
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow: hidden;
      user-select: none;
    }

    #desktop {
      height: 100%;
      background: linear-gradient(to bottom, #1e293b, #0f172a);
      position: relative;
      padding: 20px;
    }

    .icon {
      position: absolute;
      width: 80px;
      text-align: center;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: background 0.15s;
    }

    .icon:hover, .icon.selected {
      background: rgba(255,255,255,0.08);
    }

    .icon i { font-size: 2.8rem; display: block; margin-bottom: 6px; }
    .icon span { font-size: 0.82rem; word-break: break-word; display: block; }

    .window {
      position: absolute;
      width: 600px;
      height: 400px;
      background: var(--surface);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: var(--shadow);
      display: none;
      flex-direction: column;
    }

    .titlebar {
      height: 36px;
      background: #0f172a;
      display: flex;
      align-items: center;
      padding: 0 12px;
      font-weight: bold;
      cursor: move;
    }

    .titlebar button {
      margin-left: auto;
      background: #ef4444;
      border: none;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      cursor: pointer;
    }

    .content {
      flex: 1;
      padding: 20px;
      overflow: auto;
    }

    #taskbar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 48px;
      background: var(--surface);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255,255,255,0.08);
      display: flex;
      align-items: center;
      padding: 0 16px;
      z-index: 1000;
    }

    #startBtn {
      background: var(--accent);
      color: black;
      padding: 8px 16px;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      margin-right: 16px;
    }

    #startMenu {
      position: fixed;
      bottom: 56px;
      left: 16px;
      width: 320px;
      background: var(--surface);
      border-radius: 10px;
      box-shadow: var(--shadow);
      padding: 16px;
      display: none;
      z-index: 999;
    }

    #contextMenu {
      position: fixed;
      background: var(--surface);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 6px;
      padding: 8px 0;
      box-shadow: var(--shadow);
      z-index: 10000;
      display: none;
    }

    #contextMenu div {
      padding: 8px 24px;
      cursor: pointer;
    }

    #contextMenu div:hover {
      background: rgba(255,255,255,0.1);
    }

    .hidden { display: none !important; }
  </style>
</head>
<body>

  <div id="desktop"></div>

  <div id="taskbar">
    <div id="startBtn"><i class="fa fa-mountain-sun"></i> Rock</div>
    <div id="taskbarIcons"></div>
    <div style="margin-left:auto; font-variant-numeric: tabular-nums;" id="clock">00:00</div>
  </div>

  <div id="startMenu" class="hidden">
    <h3 style="margin-bottom:12px;">Rock OS</h3>
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
      <div class="icon" onclick="openWindow('files')"><i class="fa fa-folder"></i><span>Files</span></div>
      <div class="icon" onclick="openWindow('terminal')"><i class="fa fa-terminal"></i><span>Terminal</span></div>
      <div class="icon" onclick="openWindow('settings')"><i class="fa fa-gear"></i><span>Settings</span></div>
      <div class="icon" onclick="alert('About Rock OS\n\nVersion 0.1\nSingle-file browser OS')"><i class="fa fa-info-circle"></i><span>About</span></div>
    </div>
  </div>

  <div id="contextMenu">
    <div onclick="createIcon()">New Icon</div>
    <div onclick="alert('Refresh desktop')">Refresh</div>
    <div onclick="document.getElementById('startMenu').classList.toggle('hidden')">Open Start</div>
    <div onclick="alert('View settings')">Settings</div>
  </div>

<script>
// ──────────────────────────────────────────────
// Clock
// ──────────────────────────────────────────────
setInterval(() => {
  const now = new Date();
  document.getElementById('clock').textContent = now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
}, 1000);

// ──────────────────────────────────────────────
// Drag windows + icon positioning
// ──────────────────────────────────────────────
let selectedWindow = null;
let offsetX, offsetY;

document.addEventListener('mousedown', e => {
  if (e.target.closest('.titlebar')) {
    selectedWindow = e.target.closest('.window');
    offsetX = e.clientX - selectedWindow.offsetLeft;
    offsetY = e.clientY - selectedWindow.offsetTop;
  }
});

document.addEventListener('mousemove', e => {
  if (selectedWindow) {
    selectedWindow.style.left = (e.clientX - offsetX) + 'px';
    selectedWindow.style.top  = (e.clientY - offsetY) + 'px';
  }
});

document.addEventListener('mouseup', () => {
  selectedWindow = null;
});

// ──────────────────────────────────────────────
// Desktop icons
// ──────────────────────────────────────────────
const icons = [
  { name: "Files", icon: "fa-folder", x: 40, y: 40, action: () => openWindow('files') },
  { name: "Terminal", icon: "fa-terminal", x: 40, y: 140, action: () => openWindow('terminal') },
  { name: "Settings", icon: "fa-gear", x: 40, y: 240, action: () => openWindow('settings') },
];

function renderIcons() {
  const desk = document.getElementById('desktop');
  desk.innerHTML = '';
  icons.forEach((ic, i) => {
    const el = document.createElement('div');
    el.className = 'icon';
    el.style.left = ic.x + 'px';
    el.style.top  = ic.y + 'px';
    el.innerHTML = `<i class="fa ${ic.icon}"></i><span>${ic.name}</span>`;
    el.ondblclick = ic.action;
    el.onmousedown = e => {
      if (e.button === 0) {
        document.querySelectorAll('.icon').forEach(i => i.classList.remove('selected'));
        el.classList.add('selected');
      }
    };
    desk.appendChild(el);
  });
}

// ──────────────────────────────────────────────
// Windows
// ──────────────────────────────────────────────
function openWindow(id) {
  let win = document.getElementById('win-' + id);
  if (win) {
    win.style.display = 'flex';
    win.style.zIndex = Date.now();
    return;
  }

  win = document.createElement('div');
  win.id = 'win-' + id;
  win.className = 'window';
  win.style.left = (Math.random() * 300 + 100) + 'px';
  win.style.top  = (Math.random() * 200 + 80) + 'px';
  win.style.display = 'flex';
  win.innerHTML = `
    <div class="titlebar">
      <span>${id.charAt(0).toUpperCase() + id.slice(1)}</span>
      <button onclick="this.closest('.window').remove()">×</button>
    </div>
    <div class="content">
      <h2>Welcome to ${id}</h2>
      <p>This is a placeholder ${id} window in Rock OS.</p>
      ${id === 'terminal' ? '<pre>$ echo "Hello from Rock OS terminal!"</pre>' : ''}
      ${id === 'files' ? '<p>Files would appear here...</p>' : ''}
      ${id === 'settings' ? '<p>Change theme, wallpaper, etc. (coming soon)</p>' : ''}
    </div>
  `;
  document.body.appendChild(win);
}

// ──────────────────────────────────────────────
// Start menu
// ──────────────────────────────────────────────
document.getElementById('startBtn').onclick = () => {
  document.getElementById('startMenu').classList.toggle('hidden');
};

// ──────────────────────────────────────────────
// Right-click menu
// ──────────────────────────────────────────────
document.getElementById('desktop').oncontextmenu = e => {
  e.preventDefault();
  const menu = document.getElementById('contextMenu');
  menu.style.left = e.pageX + 'px';
  menu.style.top  = e.pageY + 'px';
  menu.style.display = 'block';

  const hide = () => { menu.style.display = 'none'; document.removeEventListener('click', hide); };
  document.addEventListener('click', hide, {once: true});
};

function createIcon() {
  const name = prompt("Icon name?");
  if (!name) return;
  icons.push({
    name,
    icon: "fa-star",
    x: Math.random() * 400 + 100,
    y: Math.random() * 300 + 100,
    action: () => alert("Hello from " + name)
  });
  renderIcons();
}

// ──────────────────────────────────────────────
// Init
// ──────────────────────────────────────────────
renderIcons();
</script>
</body>
</html>
